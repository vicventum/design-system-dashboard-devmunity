import { Meta } from '@storybook/addon-docs/blocks'

<Meta title='Guides/Style Architecture' />

# Design System Style Architecture

This documentation describes the complete CSS style structure implemented in the Design System, including the base configuration, component system, and semantic color palette. The goal is to provide a clear guide for developers who consume or extend this system.

---

## 1. CSS File Structure

The Design System implements a modular CSS style architecture organized in well-defined layers. This structure facilitates maintenance, scalability, and customization of the system.

```text
app/
â””â”€â”€ assets/
    â””â”€â”€ css/
        â”œâ”€â”€ settings/           # ğŸ›ï¸ Base configurations
        â”‚   â”œâ”€â”€ base.css        # Fundamental styles
        â”‚   â”œâ”€â”€ colors.css      # Raw color palette
        â”‚   â”œâ”€â”€ utilities.css   # Specific CSS utilities
        â”‚   â””â”€â”€ variables.css   # Custom CSS variables
        â”œâ”€â”€ themes/             # ğŸ¨ Theme system
        â”‚   â”œâ”€â”€ components/     # Component themes
        â”‚   â””â”€â”€ index.ts        # Centralized export
        â””â”€â”€ main.css            # ğŸš€ Main entry point
```

### 1.1 File Description in `settings/`

The `settings/` directory contains the fundamental files that define the visual base of the system:

- **`base.css`**
  Contains the base styles of the project, generally applied directly to HTML elements. Here are defined, for example:
    - Base typographies for titles and paragraphs
    - Scrollbar styles
    - Normalizations or global adjustments
    - Base rules that must be consistent throughout the application

- **`colors.css`**
  Defines the raw color palette of the design system. These colors are not yet assigned to semantic roles and serve as a base to build the project's color system.
- **`utilities.css`**
  Includes specific utility classes of the project that are not part of Tailwind CSS or that encapsulate repeated patterns within the design.
- **`variables.css`**
  Contains CSS variables that allow modifying or extending values used by Tailwind CSS or by the design system itself, such as typographies, sizes, or breakpoints.

### 1.2 Entry Point: `main.css`

All configuration files are consolidated in `main.css`, which acts as a single entry point for the system styles:

```css
@import 'tailwindcss';
@import '@nuxt/ui';

@import './settings/variables.css';
@import './settings/colors.css';
@import './settings/base.css';
@import './settings/utilities.css';
```

### 1.3 Integration with Nuxt

The main style file `main.css` is imported in the Nuxt configuration for its global availability:

```ts
// nuxt.config.ts

export default defineNuxtConfig({
    // ...
    css: ['#layers/design-system/app/assets/css/main.css'],
    // ...
})
```

---

## 2. Semantic Color System

### 2.1 Color System Fundamentals

The Design System implements the [Nuxt UI semantic color system](https://ui.nuxt.com/docs/getting-started/theme/design-system#colors-1), extended with the `accent` variant. Semantic colors represent functional intentionality instead of specific chromatic values, facilitating global theme changes.

### 2.2 Semantic Color Palette

<table>
    <thead>
        <tr>
            <th>Color</th>
            <th>Application</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                <code>primary</code>
            </td>
            <td>Main CTAs, active navigation, brand elements, featured links</td>
        </tr>
        <tr>
            <td>
                <code>secondary</code>
            </td>
            <td>Secondary buttons, alternative actions, complementary interface elements</td>
        </tr>
        <tr>
            <td>
                <code>accent</code>
            </td>
            <td>
                Featured elements, specific attention calls, highlighting of key details and interactive
                visual emphasis
            </td>
        </tr>
        <tr>
            <td>
                <code>success</code>
            </td>
            <td>Confirmation messages, completed states, positive validations</td>
        </tr>
        <tr>
            <td>
                <code>info</code>
            </td>
            <td>Informational alerts, tooltips, help text, neutral notifications</td>
        </tr>
        <tr>
            <td>
                <code>warning</code>
            </td>
            <td>Warning messages, pending states, elements that require user attention</td>
        </tr>
        <tr>
            <td>
                <code>error</code>
            </td>
            <td>Error messages, validation errors, destructive actions</td>
        </tr>
        <tr>
            <td>
                <code>neutral</code>
            </td>
            <td>General text, borders, backgrounds, disabled states</td>
        </tr>
    </tbody>
</table>

> âš ï¸ **Important:** Although the default colors of Tailwind CSS remain available (along with any additional color that is defined), these should be reserved for arbitrary and very specific cases (for example for those elements where you want the color to prevail even if there is a change of theme). The use of semantic colors is the recommended practice for the maintainability and consistency benefits they provide.

### 2.3 Base Color Definition

The base colors of the Design System are defined in `colors.css`. By convention, the prefix `brand-` is used to distinguish them from the native colors of Tailwind CSS:

```css
/* app/assets/css/settings/colors.css */

@theme static {
    --color-brand-blue-50: #ebf5ff;
    --color-brand-blue-100: #e1effe;
    --color-brand-blue-200: #c4defd;
    --color-brand-blue-300: #a4cafe;
    --color-brand-blue-400: #75a8fa;
    --color-brand-blue-500: #3f83f8;
    --color-brand-blue-600: #1c64f2;
    --color-brand-blue-700: #1a57db;
    --color-brand-blue-800: #1e439f;
    --color-brand-blue-900: #233876;
    --color-brand-blue-950: #1c044f;

    --color-brand-grey-0: #ffffff;
    --color-brand-grey-50: #f9fafb;
    --color-brand-grey-100: #f3f4f6;
    --color-brand-grey-200: #e5e7eb;
    --color-brand-grey-300: #d1d5db;
    --color-brand-grey-400: #9ca3b0;
    --color-brand-grey-500: #6b7280;
    --color-brand-grey-600: #4b5563;
    --color-brand-grey-700: #384252;
    --color-brand-grey-800: #1f2a37;
    --color-brand-grey-900: #111927;
    --color-brand-grey-950: #0b121e;
    --color-brand-grey-1000: #000;

    /* Additional colors... */
}
```

### 2.4 Semantic Color Assignment

The base colors are assigned to their respective semantic names in `app.config.ts`:

```ts
// app.config.ts

import * as components from '#layers/design-system/app/assets/css/themes'

export default defineAppConfig({
    ui: {
        ...components,
        colors: {
            primary: 'brand-blue',
            secondary: 'brand-purple',
            accent: 'brand-yellow',
            success: 'brand-green',
            warning: 'brand-orange',
            error: 'brand-red',
            info: 'brand-blue-sky',
            neutral: 'brand-grey',
        },
    },
})
```

### 2.5 Registration of Custom Colors in Nuxt UI

For the `accent` variant (and any additional semantic color), it is necessary to register the colors in `nuxt.config.ts`:

```ts
// nuxt.config.ts

export default defineNuxtConfig({
    // ...
    ui: {
        theme: {
            colors: ['primary', 'secondary', 'accent', 'info', 'success', 'warning', 'error'],
        },
    },
    // ...
})
```

---

## 3. Color Management in Consumer Applications

### 3.1 Modification and Extension of Semantic Colors

When extending the Design System as a Nuxt layer, the default semantic colors are automatically available. To modify or add new colors from a consumer application:

1. **Define base colors:** Add the new colors in `colors.css`
2. **Assign semantic names:** Map the colors in `app.config.ts`

### 3.2 Critical Consideration: Color Preservation

It is fundamental to establish **all** semantic colors when making modifications, even if only one wants to be changed. This is because the absence of definitions will cause components not to load their colors correctly.

**Correct implementation:**

```ts
// app.config.ts

import appConfig from 'design-system-dashboard-devmunity/app/app.config'

export default defineAppConfig({
    ui: {
        // ...
        colors: {
            primary: 'teal',
            ...appConfig.ui.colors,
        },
    },
})
```

**Incorrect implementation:**

```ts
// app.config.ts

export default defineAppConfig({
    ui: {
        // ...
        colors: {}, // âŒ Component colors will not load
    },
})
```

> âš ï¸ **Warning:** An empty `colors` object or with incomplete definitions will result in components rendered without their color styles, significantly affecting the visual appearance of the application.

---

## 4. Base Style Customization

### 4.1 Overriding Tailwind CSS Variables

The Design System provides minimal base styles configured in `base.css`. However, when using Tailwind CSS as a style engine, it is possible to customize default values of CSS classes, typographies, media queries, and other properties. We do this within the `variables.css` file.

To implement customizations from an application that consumes the Design System, new values must be established in the Tailwind CSS variables within the `main.css` file (or `variables.css` if the same structure is maintained).

**Typography customization example:**

```css
/* app/assets/css/settings/variables.css */

@theme static {
    --font-sans: 'Inter', system-ui, sans-serif;
}
```

> **Reference:** To learn about all available variables, consult the [official Tailwind CSS Theme documentation](https://tailwindcss.com/docs/theme).

---

## 5. Component Theming System

### 5.1 Configuration via Nuxt UI Theming

For component styles, the Design System leverages the [Nuxt UI theme system](https://ui.nuxt.com/docs/getting-started/theme/components). This approach allows modifying the base styles of Nuxt UI components through TypeScript configuration files, eliminating the need to create wrapper components with custom styles.

### 5.2 Theme Directory Structure

```text
app/
â””â”€â”€ assets/
    â””â”€â”€ css/
    â”‚   â”œâ”€â”€ settings/
    â”‚   â”œâ”€â”€ themes/
    â”‚   â”‚   â”œâ”€â”€ components/     # ğŸ§© Component configurations
    â”‚   â”‚   â”‚   â”œâ”€â”€ badge.ts    # UBadge configuration
    â”‚   â”‚   â”‚   â”œâ”€â”€ button.ts   # UButton configuration
    â”‚   â”‚   â”‚   â”œâ”€â”€ card.ts     # UCard configuration
    â”‚   â”‚   â”‚   â”œâ”€â”€ modal.ts    # UModal configuration
    â”‚   â”‚   â”‚   â””â”€â”€ ...         # Other components
    â”‚   â”‚   â””â”€â”€ index.ts        # ğŸ“¦ Centralized export
    â”‚   â””â”€â”€ main.css
    â””â”€â”€ app.config.ts
```

### 5.3 Individual Component Configuration

Each Nuxt UI component can be customized through its own configuration file, using Tailwind CSS classes to adapt the styles to the Design System.

**Example: `UBadge` Configuration**

```ts
// app/assets/css/themes/components/badge.ts

export default {
    defaultVariants: {
        color: 'neutral',
        variant: 'soft',
        size: 'sm',
    },
}
```

### 5.4 Centralized Export

All component configuration files are exported from a single point:

```ts
// app/assets/css/themes/index.ts

export { default as card } from './components/card'
export { default as button } from './components/button'
export { default as modal } from './components/modal'
export { default as badge } from './components/badge'
export { default as input } from './components/input'
```

### 5.5 Integration with `app.config.ts`

Themes are registered in the application configuration according to Nuxt UI requirements:

```ts
// app.config.ts

import * as components from '#layers/design-system/app/assets/css/themes'

export default defineAppConfig({
    ui: {
        ...components,
        // ...
    },
})
```

---

## 6. Extension of Component Styles

### 6.1 Customization from Consumer Applications

Although the Design System component library is designed to follow a predefined Dashboard design, its architecture allows the application of different thematic variants on the existing base.

The general theming system of the base Nuxt UI components can be modified to:

- Establish different base styles
- Add new design variants
- Adapt components to specific brand requirements

### 6.2 Implementation of Customizations

To modify the default styles of any Nuxt UI component, you must:

1. Create a component configuration file with the desired variants
2. Import it in the `app.config.ts` of the consumer project

**Example: `UBadge` Customization with rounded borders and large size**

```ts
// app/assets/css/themes/components/badge.ts

export default {
    slots: {
        base: 'rounded-full',
    },
    defaultVariants: {
        color: 'neutral',
        variant: 'soft',
        size: 'lg',
    },
}
```

---

## 7. General Recommendations

To maintain the consistency and scalability of the system:

- Maintain the Design System folder structure
- Use semantic colors instead of explicit colors
- Avoid overriding styles directly in components when it can be resolved through theming
- Centralize style configuration in dedicated files

This approach facilitates:

- Code maintainability
- Creation of new themes
- Visual consistency between projects
